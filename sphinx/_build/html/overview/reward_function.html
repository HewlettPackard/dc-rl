<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reward function &mdash; DCRL-Green 0.0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Code" href="../code/index.html" />
    <link rel="prev" title="Actions" href="actions.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            DCRL-Green
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/index.html">Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Overview</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="environment.html">Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="agents.html">Agents</a></li>
<li class="toctree-l2"><a class="reference internal" href="observations.html">Observations</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions.html">Actions</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Reward function</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#independent-rewards">Independent rewards</a></li>
<li class="toctree-l3"><a class="reference internal" href="#collaborative-rewards">Collaborative rewards</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-rewards">Custom rewards</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../code/index.html">Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../train_evaluate/index.html">Train and Evaluate Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribution_guidelines.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DCRL-Green</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Overview</a></li>
      <li class="breadcrumb-item active">Reward function</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/overview/reward_function.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="reward-function">
<h1>Reward function<a class="headerlink" href="#reward-function" title="Permalink to this headline"></a></h1>
<p>DCRL-Green provides an interface where the end-user can choose to train three agents independently of each other’s reward feedback, or consider a collaborative reward approach.</p>
<section id="independent-rewards">
<h2>Independent rewards<a class="headerlink" href="#independent-rewards" title="Permalink to this headline"></a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Agent</p></th>
<th class="head"><p>Default Reward</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>agent_ls</p></td>
<td><div class="math notranslate nohighlight">
\[r_{ls}~ =~  -(Penalty \cdot UL)-(CI \cdot Total EC) \]</div>
</td>
</tr>
<tr class="row-odd"><td><p>agent_dc</p></td>
<td><div class="math notranslate nohighlight">
\[r_{dc} ~=~ -( Total EC) \]</div>
</td>
</tr>
<tr class="row-even"><td><p>agent_bat</p></td>
<td><div class="math notranslate nohighlight">
\[r_{bat}~ =~ -(CI \cdot  Total EC) \]</div>
</td>
</tr>
</tbody>
</table>
<p>Total EC refers o the total building energy consumption (HVAC+IT), CI is the carbon intensity in the power grid indicating the inverse of the availability of green energy, and UL refers to the amount of unassigned flexible workload.
A penalty is attributed to the load shifting agent if it fails to schedule all the required load within the time horizon N.</p>
</section>
<section id="collaborative-rewards">
<h2>Collaborative rewards<a class="headerlink" href="#collaborative-rewards" title="Permalink to this headline"></a></h2>
<p>The reward-sharing mechanism allows the agents to estimate the feedback from their actions in other environments.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Agent</p></th>
<th class="head"><p>Reward</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>agent_ls</p></td>
<td><div class="math notranslate nohighlight">
\[\eta \cdot r_{ls} + (1-\eta) /2 \cdot r_{dc} + (1-\eta)/2 \cdot r_{bat}\]</div>
</td>
</tr>
<tr class="row-odd"><td><p>agent_dc</p></td>
<td><div class="math notranslate nohighlight">
\[(1-\eta) /2 \cdot r_{ls} + \eta \cdot r_{dc} + (1-\eta)/2 \cdot r_{bat}\]</div>
</td>
</tr>
<tr class="row-even"><td><p>agent_bat</p></td>
<td><div class="math notranslate nohighlight">
\[(1-\eta) /2 \cdot r_{ls} + (1-\eta)/2 \cdot r_{dc} + \eta \cdot r_{bat}\]</div>
</td>
</tr>
</tbody>
</table>
<p>Users have an option to choose between the two reward mechanisms. This can be done by specifying the <span class="math notranslate nohighlight">\(\eta\)</span> value in the script.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 71%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Reward Scheme</p></th>
<th class="head"><p>Implementation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Collaborative</p></td>
<td><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;individual_reward_weight&#39;</span>:<span class="w"> </span><span class="m">0</span>.33
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>Independent</p></td>
<td><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;individual_reward_weight&#39;</span>:<span class="w"> </span><span class="m">1</span>.0
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>Default
(weighted)</p></td>
<td><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;individual_reward_weight&#39;</span>:<span class="w"> </span><span class="m">0</span>.8
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="custom-rewards">
<h2>Custom rewards<a class="headerlink" href="#custom-rewards" title="Permalink to this headline"></a></h2>
<p>DCRL-Green inludes an option to include custom rewards to match user’s the desired optimization objective.</p>
<p><strong>Step 1:</strong>
users can define these reward functions in <code class="code docutils literal notranslate"><span class="pre">utils/reward_creator.py</span></code>. The function can follow the schema:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>def<span class="w"> </span>custom_agent_reward<span class="o">(</span>params:<span class="w"> </span>dict<span class="o">)</span><span class="w"> </span>-&gt;<span class="w"> </span>float:
<span class="w">    </span><span class="c1">#read reward input parameters from dict object</span>
<span class="w">    </span><span class="c1">#custom reward calculations</span>
<span class="w">    </span><span class="nv">custom_reward</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="c1">#update with custom reward shaping</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>custom_reward
</pre></div>
</div>
<p><strong>Step 2:</strong>
Add the new custom reward function to the <code class="code docutils literal notranslate"><span class="pre">REWARD_METHOD_MAP</span></code> dictionary.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">REWARD_METHOD_MAP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span>
<span class="s1">&#39;default_dc_reward&#39;</span><span class="w"> </span>:<span class="w"> </span>default_dc_reward,
<span class="s1">&#39;default_bat_reward&#39;</span>:<span class="w"> </span>default_bat_reward,
<span class="s1">&#39;default_ls_reward&#39;</span><span class="w"> </span>:<span class="w"> </span>default_ls_reward,
<span class="c1"># Additional rewards methods</span>
<span class="s1">&#39;tou_reward&#39;</span><span class="w"> </span>:<span class="w"> </span>tou_reward,
<span class="s1">&#39;renewable_energy_reward&#39;</span><span class="w"> </span>:<span class="w"> </span>renewable_energy_reward,
<span class="s1">&#39;energy_efficiency_reward&#39;</span><span class="w"> </span>:<span class="w"> </span>energy_efficiency_reward,
<span class="s1">&#39;energy_PUE_reward&#39;</span><span class="w"> </span>:<span class="w"> </span>energy_PUE_reward,
<span class="s1">&#39;temperature_efficiency_reward&#39;</span><span class="w"> </span>:<span class="w"> </span>temperature_efficiency_reward,
<span class="c1"># Add custom reward methods here</span>
<span class="s1">&#39;custom_agent_reward&#39;</span><span class="w"> </span>:<span class="w"> </span>custom_agent_reward,
<span class="s1">&#39;how_you_want_to_call_it&#39;</span><span class="w"> </span>:<span class="w"> </span>how_is_the_function_called,
<span class="o">}</span>
</pre></div>
</div>
<p>A dictionary of environment parameters (<code class="code docutils literal notranslate"><span class="pre">reward_params</span></code>) is available to users in <code class="code docutils literal notranslate"><span class="pre">dcrl_env.py</span></code> or <code class="code docutils literal notranslate"><span class="pre">dcrl_eplus_env.py</span></code>.
This dictionary consists of the information dictionary of each environment, and some other global variables such as time, day, carbon intensity, outside temperature, etc.
If another user wants to add another parameter, the parameter must be added in the dictionary <code class="code docutils literal notranslate"><span class="pre">reward_params</span></code>. Using that, that variable will be visible in the reward function.
Within the dictionary, the following environment parameters are available to users:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">bat_action</span></code></p></td>
<td><p>0</p></td>
<td><p>Action of the battery agent</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">bat_SOC</span></code></p></td>
<td><p>0.15</p></td>
<td><p>Battery state of charge</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">bat_CO2_footprint</span></code></p></td>
<td><p>380899.11</p></td>
<td><p>CO2 Footprint obtained after the battery action</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">bat_avg_CI</span></code></p></td>
<td><p>500.63</p></td>
<td><p>Carbon Intensity used in Battery (same as current CI)</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">bat_total_energy_without_battery_KWh</span></code></p></td>
<td><p>610.82</p></td>
<td><p>Total energy (KWh) consumed before battery action</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">bat_total_energy_with_battery_KWh</span></code></p></td>
<td><p>760.82</p></td>
<td><p>Total energy (KWh) consumed after battery action</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">bat_max_bat_cap</span></code></p></td>
<td><p>2</p></td>
<td><p>Battery maximum capacity (KWh)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">bat_a_t</span></code></p></td>
<td><p>charge</p></td>
<td><p>Name of the action of the battery agent</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">bat_dcload_min</span></code></p></td>
<td><p>0.6</p></td>
<td><p>Datacenter minimal energy consumption (MWh). Used in normalization.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">bat_dcload_max</span></code></p></td>
<td><p>1.81</p></td>
<td><p>Datacenter maximal energy consumption (MWh). Used in normalization.</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">ls_original_workload</span></code></p></td>
<td><p>0.69</p></td>
<td><p>Normalized original workload (%) before load shifting agent</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">ls_shifted_workload</span></code></p></td>
<td><p>0.69</p></td>
<td><p>Normalized shifted workload (%) after load shifting agent</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">ls_action</span></code></p></td>
<td><p>1</p></td>
<td><p>Action of the load shifting agent</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">ls_norm_load_left</span></code></p></td>
<td><p>1</p></td>
<td><p>Normalized current unassigned flexible workload</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">ls_unasigned_day_load_left</span></code></p></td>
<td><p>0</p></td>
<td><p>Total end of the day unassigned flexible workload</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">ls_penalty_flag</span></code></p></td>
<td><p>FALSE</p></td>
<td><p>Flag to indicate that at the end of the day, there is some workload unassigned.</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">dc_ITE_total_power_kW</span></code></p></td>
<td><p>2443.31</p></td>
<td><p>IT total power consumption (KW)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">dc_HVAC_total_power_kW</span></code></p></td>
<td><p>0</p></td>
<td><p>HVAC total power consumption (KW). It doesn’t consider the CRAC Fan load, CRAC Cooling load, or the Compressor load because these have constant  power consumption.</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">dc_total_power_kW</span></code></p></td>
<td><p>2443.31</p></td>
<td><p>Total power consumption (KW)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">dc_energy_lb_kW</span></code></p></td>
<td><p>40000</p></td>
<td><p>Lower bound in the normalization of the datacenter energy consumption (W)</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">dc_energy_ub_kW</span></code></p></td>
<td><p>160000</p></td>
<td><p>Upper bound in the normalization of the datacenter energy consumption (W)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">dc_crac_setpoint_delta</span></code></p></td>
<td><p>-5</p></td>
<td><p>HVAC temperature delta change in the setpoint</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">dc_crac_setpoint</span></code></p></td>
<td><p>15</p></td>
<td><p>HVAC current temperature setpoint (C )</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">dc_cpu_workload_percent</span></code></p></td>
<td><p>0.69</p></td>
<td><p>Normalized shifted workload (%) that the dc agent is using. Is the same as ls_shifted_workload</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">dc_int_temperature</span></code></p></td>
<td><p>29.60</p></td>
<td><p>Room temperature (C )</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">outside_temp</span></code></p></td>
<td><p>3.50</p></td>
<td><p>Outside temperature (C )</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">day_of_the_year</span></code></p></td>
<td><p>0</p></td>
<td><p>Day of the year</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">hour</span></code></p></td>
<td><p>0.25</p></td>
<td><p>Hour.Fraction of the hour.</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">day_workload</span></code></p></td>
<td><p>0</p></td>
<td><p>Total flexible workload at the start of the day</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">norm_CI</span></code></p></td>
<td></td>
<td><p>current normalized carbon intensity</p></td>
</tr>
</tbody>
</table>
<p>Depending on the objective and customized requirements, the user can use a combination of these parameters to define their customized rewards, or use other reward functions already provided.</p>
<p>Some examples of custom rewards are listed below:</p>
<p><em>Example 1</em></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>def<span class="w"> </span>energy_PUE_reward<span class="o">(</span>params:<span class="w"> </span>dict<span class="o">)</span><span class="w"> </span>-&gt;<span class="w"> </span>float:
<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Calculates a reward value based on Power Usage Effectiveness (PUE).</span>

<span class="s2">    Args:</span>
<span class="s2">        params (dict): Dictionary containing parameters:</span>
<span class="s2">            total_energy_consumption (float): Total energy consumption of the data center.</span>
<span class="s2">            it_equipment_energy (float): Energy consumed by the IT equipment.</span>

<span class="s2">    Returns:</span>
<span class="s2">        float: Reward value.</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="nv">total_energy_consumption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>params<span class="o">[</span><span class="s1">&#39;total_energy_consumption&#39;</span><span class="o">]</span>
<span class="w">    </span><span class="nv">it_equipment_energy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>params<span class="o">[</span><span class="s1">&#39;it_equipment_energy&#39;</span><span class="o">]</span>

<span class="w">    </span><span class="c1"># Calculate PUE</span>
<span class="w">    </span><span class="nv">pue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>total_energy_consumption<span class="w"> </span>/<span class="w"> </span>it_equipment_energy<span class="w"> </span><span class="k">if</span><span class="w"> </span>it_equipment_energy<span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>float<span class="o">(</span><span class="s1">&#39;inf&#39;</span><span class="o">)</span>

<span class="w">    </span><span class="c1"># We aim to get PUE as close to 1 as possible, hence we take the absolute difference between PUE and 1</span>
<span class="w">    </span><span class="c1"># We use a negative sign since RL seeks to maximize reward, but we want to minimize PUE</span>
<span class="w">    </span><span class="nv">reward</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-abs<span class="o">(</span>pue<span class="w"> </span>-<span class="w"> </span><span class="m">1</span><span class="o">)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span>reward
</pre></div>
</div>
<p><em>How to use this custom reward function</em></p>
<p>To use this custom reward function, the reward function must be declared in the <code class="code docutils literal notranslate"><span class="pre">REWARD_METHOD_MAP</span></code>.
In this case, by default, the reward function is already declared as <code class="code docutils literal notranslate"><span class="pre">'energy_PUE_reward'</span> <span class="pre">:</span> <span class="pre">energy_PUE_reward,</span></code>.
Therefore, to use the reward function as a reward function of an agent (i.e., agent dc, the agent that modifies the HVAC setpoint), in the algorithm definition (i.e., <code class="code docutils literal notranslate"><span class="pre">train_ppo.py</span></code>),
the reward definition of the dc agent must be declared as <code class="code docutils literal notranslate"><span class="pre">dc_reward:energy_PUE_reward</span></code> within the env_config dictionary.</p>
<p>The following piece of code show how to declare the <code class="code docutils literal notranslate"><span class="pre">'energy_PUE_reward'</span></code> as reward function for the dc agent:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">CONFIG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">(</span>
<span class="w">    </span>PPOConfig<span class="o">()</span>
<span class="w">    </span>.environment<span class="o">(</span>
<span class="w">        </span><span class="nv">env</span><span class="o">=</span>DCRL<span class="w"> </span><span class="k">if</span><span class="w"> </span>not<span class="w"> </span>os.getenv<span class="o">(</span><span class="s1">&#39;EPLUS&#39;</span><span class="o">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>DCRLeplus,
<span class="w">        </span><span class="nv">env_config</span><span class="o">={</span>
<span class="w">            </span><span class="c1"># Agents active</span>
<span class="w">            </span><span class="s1">&#39;agents&#39;</span>:<span class="w"> </span><span class="o">[</span><span class="s1">&#39;agent_ls&#39;</span>,<span class="w"> </span><span class="s1">&#39;agent_dc&#39;</span>,<span class="w"> </span><span class="s1">&#39;agent_bat&#39;</span><span class="o">]</span>,

<span class="w">            </span><span class="c1"># Other configurations ....</span>

<span class="w">            </span><span class="c1"># Specify reward methods</span>
<span class="w">            </span><span class="s1">&#39;ls_reward&#39;</span>:<span class="w"> </span><span class="s1">&#39;default_ls_reward&#39;</span>,
<span class="w">            </span>**<span class="s1">&#39;dc_reward&#39;</span>:<span class="w"> </span><span class="s1">&#39;energy_PUE_reward&#39;</span>,**
<span class="w">            </span><span class="s1">&#39;bat_reward&#39;</span>:<span class="w"> </span><span class="s1">&#39;default_bat_reward&#39;</span>
<span class="w">        </span><span class="o">}</span>
</pre></div>
</div>
<p>Other reward function definitions can be found here:
<em>Example 2</em></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>def<span class="w"> </span>tou_reward<span class="o">(</span>params:<span class="w"> </span>dict<span class="o">)</span><span class="w"> </span>-&gt;<span class="w"> </span>float:
<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Calculates a reward value based on the Time of Use (ToU) of energy.</span>

<span class="s2">    Args:</span>
<span class="s2">        params (dict): Dictionary containing parameters:</span>
<span class="s2">            energy_usage (float): The energy usage of the agent.</span>
<span class="s2">            hour (int): The current hour of the day (24-hour format).</span>

<span class="s2">    Returns:</span>
<span class="s2">        float: Reward value.</span>
<span class="s2">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="c1"># ToU dict: {Hour, price}</span>
<span class="w">    </span><span class="nv">tou</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span><span class="m">0</span>:<span class="w"> </span><span class="m">0</span>.25,
<span class="w">        </span><span class="m">1</span>:<span class="w"> </span><span class="m">0</span>.25,
<span class="w">        </span><span class="m">2</span>:<span class="w"> </span><span class="m">0</span>.25,
<span class="w">        </span><span class="m">3</span>:<span class="w"> </span><span class="m">0</span>.25,
<span class="w">        </span><span class="m">4</span>:<span class="w"> </span><span class="m">0</span>.25,
<span class="w">        </span><span class="m">5</span>:<span class="w"> </span><span class="m">0</span>.25,
<span class="w">        </span><span class="m">6</span>:<span class="w"> </span><span class="m">0</span>.41,
<span class="w">        </span><span class="m">7</span>:<span class="w"> </span><span class="m">0</span>.41,
<span class="w">        </span><span class="m">8</span>:<span class="w"> </span><span class="m">0</span>.41,
<span class="w">        </span><span class="m">9</span>:<span class="w"> </span><span class="m">0</span>.41,
<span class="w">        </span><span class="m">10</span>:<span class="w"> </span><span class="m">0</span>.41,
<span class="w">        </span><span class="m">11</span>:<span class="w"> </span><span class="m">0</span>.30,
<span class="w">        </span><span class="m">12</span>:<span class="w"> </span><span class="m">0</span>.30,
<span class="w">        </span><span class="m">13</span>:<span class="w"> </span><span class="m">0</span>.30,
<span class="w">        </span><span class="m">14</span>:<span class="w"> </span><span class="m">0</span>.30,
<span class="w">        </span><span class="m">15</span>:<span class="w"> </span><span class="m">0</span>.30,
<span class="w">        </span><span class="m">16</span>:<span class="w"> </span><span class="m">0</span>.27,
<span class="w">        </span><span class="m">17</span>:<span class="w"> </span><span class="m">0</span>.27,
<span class="w">        </span><span class="m">18</span>:<span class="w"> </span><span class="m">0</span>.27,
<span class="w">        </span><span class="m">19</span>:<span class="w"> </span><span class="m">0</span>.27,
<span class="w">        </span><span class="m">20</span>:<span class="w"> </span><span class="m">0</span>.27,
<span class="w">        </span><span class="m">21</span>:<span class="w"> </span><span class="m">0</span>.27,
<span class="w">        </span><span class="m">22</span>:<span class="w"> </span><span class="m">0</span>.25,
<span class="w">        </span><span class="m">23</span>:<span class="w"> </span><span class="m">0</span>.25,
<span class="w">        </span><span class="o">}</span>

<span class="w">    </span><span class="c1"># Obtain the price of electricity at the current hour</span>
<span class="w">    </span><span class="nv">current_price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>tou<span class="o">[</span>params<span class="o">[</span><span class="s1">&#39;hour&#39;</span><span class="o">]]</span>
<span class="w">    </span><span class="c1"># Obtain the energy usage</span>
<span class="w">    </span><span class="nv">energy_usage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>params<span class="o">[</span><span class="s1">&#39;bat_total_energy_with_battery_KWh&#39;</span><span class="o">]</span>

<span class="w">    </span><span class="c1"># The reward is negative as the agent&#39;s objective is to minimize energy cost</span>
<span class="w">    </span><span class="nv">tou_reward</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-1.0<span class="w"> </span>*<span class="w"> </span>energy_usage<span class="w"> </span>*<span class="w"> </span>current_price

<span class="w">    </span><span class="k">return</span><span class="w"> </span>tou_reward
</pre></div>
</div>
<p><em>Example 3</em></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>def<span class="w"> </span>renewable_energy_reward<span class="o">(</span>params:<span class="w"> </span>dict<span class="o">)</span><span class="w"> </span>-&gt;<span class="w"> </span>float:
<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Calculates a reward value based on the usage of renewable energy sources.</span>

<span class="s2">    Args:</span>
<span class="s2">        params (dict): Dictionary containing parameters:</span>
<span class="s2">            renewable_energy_ratio (float): Ratio of energy coming from renewable sources.</span>
<span class="s2">            total_energy_consumption (float): Total energy consumption of the data center.</span>

<span class="s2">    Returns:</span>
<span class="s2">        float: Reward value.</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="w">    </span>assert<span class="w"> </span>params.get<span class="o">(</span><span class="s1">&#39;renewable_energy_ratio&#39;</span><span class="o">)</span><span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>None,<span class="w"> </span><span class="s1">&#39;renewable_energy_ratio is not defined. This parameter should be included using some external dataset and added to the reward_info dictionary&#39;</span>
<span class="w">    </span><span class="nv">renewable_energy_ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>params<span class="o">[</span><span class="s1">&#39;renewable_energy_ratio&#39;</span><span class="o">]</span><span class="w"> </span><span class="c1"># This parameter should be included using some external dataset</span>
<span class="w">    </span><span class="nv">total_energy_consumption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>params<span class="o">[</span><span class="s1">&#39;bat_total_energy_with_battery_KWh&#39;</span><span class="o">]</span>
<span class="w">    </span><span class="nv">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>.0<span class="w"> </span><span class="c1"># factor to scale the weight of the renewable energy usage</span>

<span class="w">    </span><span class="c1"># Reward = maximize renewable energy usage - minimize total energy consumption</span>
<span class="w">    </span><span class="nv">reward</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>factor<span class="w"> </span>*<span class="w"> </span>renewable_energy_ratio<span class="w">  </span>-1.0<span class="w"> </span>*<span class="w"> </span>total_energy_consumption
<span class="w">    </span><span class="k">return</span><span class="w"> </span>reward
</pre></div>
</div>
<p><em>Example 4</em></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>def<span class="w"> </span>energy_efficiency_reward<span class="o">(</span>params:<span class="w"> </span>dict<span class="o">)</span><span class="w"> </span>-&gt;<span class="w"> </span>float:
<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Calculates a reward value based on energy efficiency.</span>

<span class="s2">    Args:</span>
<span class="s2">        params (dict): Dictionary containing parameters:</span>
<span class="s2">            ITE_load (float): The amount of energy spent on computation (useful work).</span>
<span class="s2">            total_energy_consumption (float): Total energy consumption of the data center.</span>

<span class="s2">    Returns:</span>
<span class="s2">        float: Reward value.</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="nv">it_equipment_power</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>params<span class="o">[</span><span class="s1">&#39;dc_ITE_total_power_kW&#39;</span><span class="o">]</span>
<span class="w">    </span><span class="nv">total_power_consumption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>params<span class="o">[</span><span class="s1">&#39;dc_total_power_kW&#39;</span><span class="o">]</span>

<span class="w">    </span><span class="nv">reward</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>it_equipment_power<span class="w"> </span>/<span class="w"> </span>total_power_consumption
<span class="w">    </span><span class="k">return</span><span class="w"> </span>reward
</pre></div>
</div>
<p><em>Example 5</em></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>def<span class="w"> </span>temperature_efficiency_reward<span class="o">(</span>params:<span class="w"> </span>dict<span class="o">)</span><span class="w"> </span>-&gt;<span class="w"> </span>float:
<span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Calculates a reward value based on the efficiency of cooling in the data center.</span>

<span class="s2">    Args:</span>
<span class="s2">        params (dict): Dictionary containing parameters:</span>
<span class="s2">            current_temperature (float): Current temperature in the data center.</span>
<span class="s2">            optimal_temperature_range (tuple): Tuple containing the minimum and maximum optimal temperatures for the data center.</span>

<span class="s2">    Returns:</span>
<span class="s2">        float: Reward value.</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="w">    </span>assert<span class="w"> </span>params.get<span class="o">(</span><span class="s1">&#39;optimal_temperature_range&#39;</span><span class="o">)</span><span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>None,<span class="w"> </span><span class="s1">&#39;optimal_temperature_range is not defined. This parameter should be added to the reward_info dictionary&#39;</span>
<span class="w">    </span><span class="nv">current_temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>params<span class="o">[</span><span class="s1">&#39;dc_int_temperature&#39;</span><span class="o">]</span>
<span class="w">    </span><span class="nv">optimal_temperature_range</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>params<span class="o">[</span><span class="s1">&#39;optimal_temperature_range&#39;</span><span class="o">]</span>
<span class="w">    </span>min_temp,<span class="w"> </span><span class="nv">max_temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>optimal_temperature_range

<span class="w">    </span><span class="k">if</span><span class="w"> </span>min_temp<span class="w"> </span>&lt;<span class="o">=</span><span class="w"> </span>current_temperature<span class="w"> </span>&lt;<span class="o">=</span><span class="w"> </span>max_temp:
<span class="w">        </span><span class="nv">reward</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>.0
<span class="w">    </span><span class="k">else</span>:
<span class="w">        </span><span class="k">if</span><span class="w"> </span>current_temperature<span class="w"> </span>&lt;<span class="w"> </span>min_temp:
<span class="w">            </span><span class="nv">reward</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-abs<span class="o">(</span>current_temperature<span class="w"> </span>-<span class="w"> </span>min_temp<span class="o">)</span>
<span class="w">        </span><span class="k">else</span>:
<span class="w">            </span><span class="nv">reward</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-abs<span class="o">(</span>current_temperature<span class="w"> </span>-<span class="w"> </span>max_temp<span class="o">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>reward
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="actions.html" class="btn btn-neutral float-left" title="Actions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../code/index.html" class="btn btn-neutral float-right" title="Code" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, HPE.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>